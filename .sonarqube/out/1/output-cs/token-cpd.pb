±
CC:\vsproj\beck\bia.internal.booklibrary\EmailSender\EmailService.cs
	namespace		 	
EmailSender		
 
{

 
public 

class 
EmailService 
{ 
private 
NetworkCredential !
_credential" -
;- .
private 
string 
_host 
; 
public 
EmailService 
( 
string "
host# '
,' (
string) /
user0 4
,4 5
string6 <
password= E
)E F
{ 	
_credential 
= 
new 
NetworkCredential /
(/ 0
user0 4
,4 5
password5 =
)= >
;> ?
_host 
= 
host 
; 
} 	
public 
void 
Send 
( 
MimeMessage $
message% ,
), -
{ 	
using 
( 
var 
client 
= 
new  #

SmtpClient$ .
(. /
)/ 0
)0 1
{ 
client 
. 
Connect 
( 
_host $
,$ %
$num& (
,( )
false* /
)/ 0
;0 1
client 
. 
Authenticate #
(# $
_credential$ /
)/ 0
;0 1
client 
. 
Send 
( 
message #
)# $
;$ %
} 
} 	
} 
}   ðC
@C:\vsproj\beck\bia.internal.booklibrary\EmailSender\Extension.cs
	namespace 	
EmailSender
 
{ 
public 

static 
class 
	Extension !
{ 
private 
static 
string 
_path #
=$ %
Path& *
.* +
GetDirectoryName+ ;
(; <
Assembly< D
.D E 
GetExecutingAssemblyE Y
(Y Z
)Z [
.[ \
Location\ d
)d e
;e f
public 
static 
MimeMessage !"
UserRequestMailMessage" 8
(8 9
this9 =
MimeMessage> I
msgJ M
,M N
MailConfigurationO `
configurationa n
)n o
{ 	
var 
path 
= 
_path 
+ 
$str =
;= >
var 
template 
= 
File 
.  
ReadAllText  +
(+ ,
path, 0
)0 1
;1 2
msg 
. 
Subject 
= 
$str 7
;7 8
template 
= 
template 
. 
Replace 
( 
$str &
,& '
configuration( 5
.5 6
UserName6 >
)> ?
. 
Replace 
( 
$str &
,& '
configuration( 5
.5 6
	BookTitle6 ?
)? @
. 
Replace 
( 
$str $
,$ %
configuration& 3
.3 4
BookID4 :
.: ;
ToString; C
(C D
)D E
)E F
;F G
msg 
. 
Body 
= 
new 
TextPart #
(# $
MimeKit$ +
.+ ,
Text, 0
.0 1

TextFormat1 ;
.; <
Html< @
)@ A
{ 
Text   
=   
template   
}!! 
;!! 
return"" 
msg"" 
;"" 
}## 	
public%% 
static%% 
MimeMessage%% !%
UserRequestConfirmMessage%%" ;
(%%; <
this%%< @
MimeMessage%%A L
msg%%M P
,%%P Q
MailConfiguration%%R c
configuration%%d q
)%%q r
{&& 	
var'' 
path'' 
='' 
_path'' 
+'' 
$str'' D
;''D E
var(( 
template(( 
=(( 
File(( 
.((  
ReadAllText((  +
(((+ ,
path((, 0
)((0 1
;((1 2
msg** 
.** 
Subject** 
=** 
$str** B
;**B C
template++ 
=++ 
template++ 
.,, 
Replace,, 
(,, 
$str,, &
,,,& '
configuration,,( 5
.,,5 6
UserName,,6 >
),,> ?
.-- 
Replace-- 
(-- 
$str-- &
,--& '
configuration--( 5
.--5 6
	BookTitle--6 ?
)--? @
... 
Replace.. 
(.. 
$str.. &
,..& '
configuration..( 5
...5 6
Date..6 :
)..: ;
.// 
Replace// 
(// 
$str// $
,//$ %
configuration//& 3
.//3 4
BookID//4 :
.//: ;
ToString//; C
(//C D
)//D E
)//E F
;//F G
msg11 
.11 
Body11 
=11 
new11 
TextPart11 #
(11# $
MimeKit11$ +
.11+ ,
Text11, 0
.110 1

TextFormat111 ;
.11; <
Html11< @
)11@ A
{22 
Text33 
=33 
template33 
}44 
;44 
return55 
msg55 
;55 
}66 	
public88 
static88 
MimeMessage88 !!
UserReturnBookMessage88" 7
(887 8
this888 <
MimeMessage88= H
msg88I L
,88L M
MailConfiguration88N _
configuration88` m
)88m n
{99 	
var:: 
path:: 
=:: 
_path:: 
+:: 
$str:: @
;::@ A
var;; 
template;; 
=;; 
File;; 
.;;  
ReadAllText;;  +
(;;+ ,
path;;, 0
);;0 1
;;;1 2
msg== 
.== 
Subject== 
=== 
$str== C
;==C D
template>> 
=>> 
template>> 
.?? 
Replace?? 
(?? 
$str?? &
,??& '
configuration??( 5
.??5 6
UserName??6 >
)??> ?
.@@ 
Replace@@ 
(@@ 
$str@@ &
,@@& '
configuration@@( 5
.@@5 6
	BookTitle@@6 ?
)@@? @
.AA 
ReplaceAA 
(AA 
$strAA $
,AA$ %
configurationAA& 3
.AA3 4
BookIDAA4 :
.AA: ;
ToStringAA; C
(AAC D
)AAD E
)AAE F
;AAF G
msgCC 
.CC 
BodyCC 
=CC 
newCC 
TextPartCC #
(CC# $
MimeKitCC$ +
.CC+ ,
TextCC, 0
.CC0 1

TextFormatCC1 ;
.CC; <
HtmlCC< @
)CC@ A
{DD 
TextEE 
=EE 
templateEE 
}FF 
;FF 
returnGG 
msgGG 
;GG 
}HH 	
publicJJ 
staticJJ 
MimeMessageJJ !
AdminRequestMessageJJ" 5
(JJ5 6
thisJJ6 :
MimeMessageJJ; F
msgJJG J
,JJJ K
MailConfigurationJJL ]
configurationJJ^ k
)JJk l
{KK 	
varLL 
pathLL 
=LL 
_pathLL 
+LL 
$strLL >
;LL> ?
varMM 
templateMM 
=MM 
FileMM 
.MM  
ReadAllTextMM  +
(MM+ ,
pathMM, 0
)MM0 1
;MM1 2
msgOO 
.OO 
SubjectOO 
=OO 
$strOO 7
;OO7 8
templatePP 
=PP 
templatePP 
.QQ 
ReplaceQQ 
(QQ 
$strQQ &
,QQ& '
configurationQQ( 5
.QQ5 6
UserNameQQ6 >
)QQ> ?
.RR 
ReplaceRR 
(RR 
$strRR &
,RR& '
configurationRR( 5
.RR5 6
	BookTitleRR6 ?
)RR? @
.SS 
ReplaceSS 
(SS 
$strSS $
,SS$ %
configurationSS& 3
.SS3 4
BookIDSS4 :
.SS: ;
ToStringSS; C
(SSC D
)SSD E
)SSE F
;SSF G
msgUU 
.UU 
BodyUU 
=UU 
newUU 
TextPartUU #
(UU# $
MimeKitUU$ +
.UU+ ,
TextUU, 0
.UU0 1

TextFormatUU1 ;
.UU; <
HtmlUU< @
)UU@ A
{VV 
TextWW 
=WW 
templateWW 
}XX 
;XX 
returnYY 
msgYY 
;YY 
}ZZ 	
public]] 
class]] 
MailConfiguration]] &
{^^ 	
public__ 
string__ 
UserName__ "
{__# $
get__% (
;__( )
set__* -
;__- .
}__/ 0
public`` 
string`` 
UserId``  
{``! "
get``# &
;``& '
set``( +
;``+ ,
}``- .
publicaa 
stringaa 
	BookTitleaa #
{aa$ %
getaa& )
;aa) *
setaa+ .
;aa. /
}aa0 1
publicbb 
intbb 
BookIDbb 
{bb 
getbb  #
;bb# $
setbb% (
;bb( )
}bb* +
publiccc 
stringcc 
Datecc 
{cc  
getcc! $
;cc$ %
setcc& )
;cc) *
}cc+ ,
publicdd 
stringdd 
	AdminMaildd #
{dd$ %
getdd& )
;dd) *
setdd+ .
;dd. /
}dd0 1
}ee 	
}hh 
}ii 